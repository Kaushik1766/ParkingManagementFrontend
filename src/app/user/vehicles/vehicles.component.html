<app-loader [isLoading]="isLoading()" />
<p-toast />
<div class="header">
  <h1>User Vehicles</h1>
  <h2>Manage your registered vehicles and parking</h2>
</div>

<div class="add-vehicle">
  <h3>Register Vehicle</h3>
  <form [formGroup]="this.vehicleForm" (submit)="addVehicle()" >
    <div class="form-inputs">
      <p-floatlabel variant="on">
        <input pInputText id="numberplate" formControlName="numberPlate" fluid autocomplete="off" />
        @if(isNumberPlateInvalid){
          <p-message severity="error" variant="simple" size="small">{{ messages.ERRORS.NUMBER_PLATE_INVALID }}</p-message>
        }
        <label for="numberplate">Number Plate</label>
      </p-floatlabel>
      <p-floatlabel variant="on" class="text-accent">
        <p-select [options]="vehicleTypes" optionLabel="vehicleType" optionValue="value" formControlName="vehicleType" fluid placeholder="Please select your vehicle type"  />
        <label for="vehicleType">Vehicle Type</label>
      </p-floatlabel>
    </div>
    <p-button type="submit" [disabled]="this.vehicleForm.invalid">Register Vehicle</p-button>
  </form>
</div>

<div class="vehicles-container">
  @for (vehicle of vehicles; track vehicle.number_plate) {
    <app-user-vehicle
      [vehicle]="vehicle"
      (onDelete)="onVehicleDelete($event)"
      (onPark)="onVehiclePark($event)"
      (onUnpark)="onVehicleUnpark($event)" />
  }

  @empty {
    <div class="empty-state">
      <p>No vehicles registered yet.</p>
      <p>Add your first vehicle to get started.</p>
    </div>
  }
</div>
